db = connect("mongodb://localhost/opcua");

result = db.data.findOne(
    { _id: "integration-tests" },
    {
        theAnswer: "$data.theAnswer",
        timeDiff: {
            $abs: {
                $subtract: [
                    { $dateFromString: { dateString: "$data.currentTimeServer" } },
                    { $dateFromString: { dateString: "$data.currentTime" } }
                ]
            }
        },
        sourceTimestampDiff: {
            $dateDiff: {
                startDate: "$sourceTimestamps.theAnswer",
                endDate: "$$NOW",
                unit: "millisecond"
            }
        }
    }
);

print(EJSON.stringify(result));

db = connect("mongodb://localhost/opcua");

db.disableFreeMonitoring();

result = db.data.findOne(
    { _id: "integration-tests" },
    {
        shouldBeMissing: { $type: "$alreadyPresent" },
        theAnswer: "$val.theAnswer",
        timeDiff: {
            $abs: {
                $subtract: [
                    { $dateFromString: { dateString: "$val.currentTimeServer" } },
                    { $dateFromString: { dateString: "$val.currentTime" } }
                ]
            }
        },
        timestampDiff: {
            $dateDiff: {
                startDate: "$ts.theAnswer",
                endDate: "$$NOW",
                unit: "millisecond"
            }
        }
    }
);

print(EJSON.stringify(result));
